(this["webpackJsonpmy-spotify"]=this["webpackJsonpmy-spotify"]||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n(0),a=n.n(o),s=n(23),c=n.n(s),i=(n(71),n(12)),u=n(9),p=n(20),l=n.n(p);n(92).config();var d=n(95),h={getUserInfo:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me",{headers:t})},authorizeUser:function(){window.open("https://accounts.spotify.com/authorize?client_id=aef81b01d4254ec195e10e20a46aa47e&response_type=code&redirect_uri="+encodeURIComponent("https://bdeguigne.github.io/Tasteify/")+"&scope="+encodeURIComponent("user-read-email user-top-read"),"_self")},getAccessToken:function(e){var t=d.stringify({client_id:"aef81b01d4254ec195e10e20a46aa47e",client_secret:"cbd956b19fcc45038880e8d2f552c13e",redirect_uri:"https://bdeguigne.github.io/Tasteify/",grant_type:"authorization_code",code:e});return l.a.post("https://accounts.spotify.com/api/token",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then()}};var f=n(36).uiConstants;var j=n(22).userConstants;function b(e,t){return function(n){var r={accessToken:e,refreshToken:t};n(function(e){return function(t){h.getUserInfo(e).then((function(e){t(function(e){return{type:j.LOG_USER_STORE_USER,user:e}}(e.data)),t((function(e){e({type:f.LOG_USER})}))}),(function(e){t(g(e))}))}}(e)),n(function(e){return{type:j.LOG_USER_STORE_TOKENS,tokens:e}}(r))}}function O(){return{type:j.LOG_USER_REQUEST}}function g(e){return{type:j.LOG_USER_FAILURE,error:e}}var T=n(147),m=n(145),_=n(148),E=(n(98),n(5)),v=n(135),S=Object(E.a)({root:{background:"linear-gradient(45deg, #74a585 30%, #1ed760 90%)",borderRadius:3,border:0,color:"white",height:48,boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)","&:hover":{border:"none",boxShadow:"5px 5px 7px 2px rgba(255, 105, 135, .3)"}}})(v.a),x={setPageTitle:function(e){return function(t){t({type:f.SET_PAGE_TITLE,name:e})}},disconnectUser:function(){return localStorage.setItem("access_token",""),localStorage.setItem("refresh_token",""),{type:j.LOG_USER_DISCONNECT}}};var R=Object(i.b)((function(e){var t=null;return e.user.user&&e.user.user.images[0]&&(t=e.user.user.images[0].url),{pageTitle:e.ui.pageTitle,userImage:t}}),x)((function(e){return Object(r.jsxs)("div",{className:"navbar-container",children:[Object(r.jsx)("div",{children:Object(r.jsx)("h1",{className:"logo",children:"Tasteify"})}),Object(r.jsx)(S,{className:"button",variant:"outlined",color:"primary",startIcon:Object(r.jsx)(_.a,{src:e.userImage}),onClick:function(){return e.disconnectUser()},children:"Disconnect"})]})})),k=n(27),L=n(6),y=n(137),U=n(146),A=n(136),G=n(138),N="SPOTIFY_DATA_TRACK_REQUEST",I="SPOTIFY_DATA_GENRE_REQUEST",C="SPOTIFY_DATA_FAILURE",w="SPOTIFY_DATA_STORE_TOP_TRACKS_LAST_MONTH",D="SPOTIFY_DATA_STORE_TOP_TRACKS_LAST_6_MONTH",M="SPOTIFY_DATA_STORE_TOP_TRACKS_ALL_TIME",P="SPOTIFY_DATA_STORE_TOP_GENRES_LAST_MONTH",F="SPOTIFY_DATA_STORE_TOP_GENRES_LAST_6_MONTH",z="SPOTIFY_DATA_STORE_TOP_GENRES_ALL_TIME",B={getTopTracksLastMonth:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me/top/tracks?limit=10&time_range=short_term",{headers:t})},getTopGenresLastMonth:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me/top/artists?limit=50&time_range=short_term",{headers:t})},getTopTracksLast6Month:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me/top/tracks?limit=10&time_range=medium_term",{headers:t})},getTopGenresLast6Month:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me/top/artists?limit=50&time_range=medium_term",{headers:t})},getTopTracksAllTime:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me/top/tracks?limit=10&time_range=long_term",{headers:t})},getTopGenresAllTime:function(e){var t={Authorization:"Bearer "+e};return l.a.get("https://api.spotify.com/v1/me/top/artists?limit=50&time_range=long_term",{headers:t})}};function q(e){var t=[];return e.forEach((function(e,n){var r=[];e.artists.forEach((function(e){r.push(e.name)}));var o={albumCoverURL:e.album.images[2].url,position:n+1,trackName:e.name,artistName:r.join(", ")};t.push(o)})),t}function Y(e){var t=[];e.forEach((function(e){e.genres.forEach((function(e){t.push(e)}))}));var n=[];t.forEach((function(e){var r=t.reduce((function(t,n){return t+(n===e)}),0),o={genre:e,count:r};n.push(o)}));var r=n.filter((function(e,t,n){return n.findIndex((function(t){return t.genre===e.genre&&t.count===e.count}))===t}));return t=function(e){console.log("COUNTED GENRES",e);var t=0;e.forEach((function(e){t+=e.count})),console.log("TOTAL",t);var n=[];return e.forEach((function(e){var r=e.count,o=r/t*100,a={genre:e.genre,percent:o.toFixed(0),count:r};n.push(a)})),n.sort(K),n}(r)}function K(e,t){return parseInt(e.percent)>parseInt(t.percent)?-1:parseInt(e.percent)<parseInt(t.percent)?1:0}function Q(){return{type:N}}function W(){return{type:I}}function H(e){return{type:C,error:e}}var J=Object(E.a)({indicator:{display:"flex",justifyContent:"center",backgroundColor:"transparent","& > span":{maxWidth:40,width:"100%",backgroundColor:"#1ED760"}}})((function(e){return Object(r.jsx)(U.a,Object(L.a)(Object(L.a)({},e),{},{TabIndicatorProps:{children:Object(r.jsx)("span",{})}}))})),X=Object(E.a)((function(e){return{root:{marginTop:"20px",textTransform:"none",color:"#fff",fontWeight:e.typography.fontWeightRegular,fontSize:e.typography.pxToRem(15),marginRight:e.spacing(1),"&:focus":{color:"#1ED760",opacity:1}}}}))((function(e){return Object(r.jsx)(A.a,Object(L.a)({disableRipple:!0},e))})),V=Object(y.a)((function(e){return{root:{flexGrow:1},padding:{padding:0},demo1:{backgroundColor:e.palette.background.paper},demo2:{backgroundColor:"#181717"}}}));var $={getTopLastMonth:function(){return function(e){e((function(e,t){var n=t().user.tokens.accessToken;e(Q()),B.getTopTracksLastMonth(n).then((function(t){var n=q(t.data.items);e(function(e){return{type:w,topTracks:e}}(n))})).catch((function(t){t.response?e(H(t.response)):e(H(t))}))})),e((function(e,t){var n=t().user.tokens.accessToken;e(W()),B.getTopGenresLastMonth(n).then((function(t){var n=Y(t.data.items);e(function(e){return{type:P,topGenres:e}}(n))})).catch((function(t){t.response?e(H(t.response)):e(H(t))}))}))}},getTopLast6Month:function(){return function(e){e((function(e,t){var n=t().user.tokens.accessToken;e(Q()),B.getTopTracksLast6Month(n).then((function(t){var n=q(t.data.items);e(function(e){return{type:D,topTracks:e}}(n))})).catch((function(t){t.response?e(H(t.response)):e(H(t))}))})),e((function(e,t){var n=t().user.tokens.accessToken;e(W()),B.getTopGenresLast6Month(n).then((function(t){var n=Y(t.data.items);e(function(e){return{type:F,topGenres:e}}(n))})).catch((function(t){t.response?e(H(t.response)):e(H(t))}))}))}},getTopAllTime:function(){return function(e){e((function(e,t){var n=t().user.tokens.accessToken;e(Q()),B.getTopTracksAllTime(n).then((function(t){var n=q(t.data.items);e(function(e){return{type:M,topTracks:e}}(n))})).catch((function(t){t.response?e(H(t.response)):e(H(t))}))})),e((function(e,t){var n=t().user.tokens.accessToken;e(W()),B.getTopGenresAllTime(n).then((function(t){var n=Y(t.data.items);e(function(e){return{type:z,topGenres:e}}(n))})).catch((function(t){t.response?e(H(t.response)):e(H(t))}))}))}}};var Z=Object(i.b)((function(e){return{}}),$)((function(e){var t=V(),n=a.a.useState(0),s=Object(k.a)(n,2),c=s[0],i=s[1];return Object(o.useEffect)((function(){0===c?e.getTopLastMonth():1===c?e.getTopLast6Month():e.getTopAllTime()}),[c,e]),Object(r.jsxs)("div",{className:t.root,children:[Object(r.jsx)("div",{className:t.demo1,children:Object(r.jsx)(G.a,{className:t.padding})}),Object(r.jsxs)("div",{className:t.demo2,children:[Object(r.jsxs)(J,{value:c,onChange:function(e,t){i(t)},"aria-label":"styled tabs example",children:[Object(r.jsx)(X,{label:"Last Month"}),Object(r.jsx)(X,{label:"Last 6 Months"}),Object(r.jsx)(X,{label:"All Time"})]}),Object(r.jsx)(G.a,{className:t.padding})]})]})})),ee=(n(99),n(142)),te=n(144),ne=n(139),re=n(141),oe=n(143),ae=n(140),se=Object(E.a)((function(e){return{head:{backgroundColor:"#181717",color:e.palette.common.white,borderBottom:"1px solid rgb(42, 36, 36)"},body:{color:"white",fontSize:14,borderBottom:"1px solid rgb(42, 36, 36)"}}}))(ne.a),ce=Object(E.a)((function(e){return{root:{transition:"background-color 0.3s ease","&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"&:hover":{backgroundColor:"#0d0d0d"}}}}))(ae.a);var ie=Object(y.a)({table:{background:"#181717",minWidth:700,paddingTop:0},title:{color:"white",marginBottom:16}});var ue=Object(i.b)((function(e){return null==e.spotifyData.topTracks?{jsdata:[]}:(console.log(e.spotifyData.topTracks),{jsdata:e.spotifyData.topTracks})}))((function(e){var t=ie(),n=Object(o.useState)([]),a=Object(k.a)(n,2),s=a[0],c=a[1];return Object(o.useEffect)((function(){var t=[];null!=e.jsdata&&(e.jsdata.forEach((function(e){var n,r,o,a;t.push((n=e.albumCoverURL,r=e.position,o=e.trackName,a=e.artistName,{img:n,nb:r,name:o,artist:a}))})),c(t))}),[e.jsdata]),Object(r.jsxs)("div",{style:{paddingTop:"160px",marginLeft:"24px",marginRight:"24px"},children:[Object(r.jsx)("h2",{children:"Top Tracks"}),Object(r.jsx)(re.a,{children:Object(r.jsxs)(ee.a,{className:t.table,size:"small","aria-label":"customized table",children:[Object(r.jsx)(oe.a,{className:"table-head",children:Object(r.jsxs)(ae.a,{children:[Object(r.jsx)(se,{}),Object(r.jsx)(se,{align:"center"}),Object(r.jsx)(se,{children:"Track"}),Object(r.jsx)(se,{children:"Artist"})]})}),Object(r.jsx)(te.a,{className:"table-body",children:s.map((function(e){return Object(r.jsxs)(ce,{children:[Object(r.jsx)(se,{className:"table-img",align:"left",children:Object(r.jsx)("img",{src:e.img,alt:""})}),Object(r.jsx)(se,{align:"center",children:e.nb}),Object(r.jsx)(se,{component:"th",scope:"row",children:e.name}),Object(r.jsx)(se,{className:"table-artist",children:e.artist})]},e.name)}))})]})})]})})),pe=n(60),le=n.n(pe);n(101);var de=Object(i.b)((function(e){return{genre:e.spotifyData.topGenres}}))((function(e){var t=Object(o.useState)([]),n=Object(k.a)(t,2),a=n[0],s=n[1],c=Object(o.useState)([]),i=Object(k.a)(c,2),u=i[0],p=i[1];Object(o.useEffect)((function(){var t=[],n=[];null!=e.genre&&(e.genre.forEach((function(e){t.push(e.genre),n.push(e.count)})),s(t),p(n))}),[e.genre]);var l={series:u,chart:{width:800,type:"donut"},labels:a,fill:{opacity:1},yaxis:{show:!1},legend:{position:"right",labels:{colors:["#fff"]},width:180},plotOptions:{polarArea:{rings:{strokeWidth:0}}},theme:{monochrome:{enabled:!1,shadeTo:"light",shadeIntensity:.6}}};return Object(r.jsxs)("div",{style:{paddingTop:"55px",marginLeft:"20px",marginRight:"20px",marginBottom:"20px"},children:[Object(r.jsx)("h2",{style:{color:"white"},children:"Top Genres"}),Object(r.jsx)("p",{children:"Based on the genres of your favorites artists"}),Object(r.jsx)("div",{className:"genres-container",children:Object(r.jsx)("div",{className:"row",children:Object(r.jsx)("div",{className:"donut",children:Object(r.jsx)(le.a,{options:l,series:l.series,type:l.chart.type,width:l.chart.width})})})})]})}));n(102);var he=function(){return Object(r.jsxs)("div",{children:[Object(r.jsxs)(T.a,{elevation:1,style:{background:"#0d0d0d",position:"fixed"},position:"static",children:[Object(r.jsx)(m.a,{children:Object(r.jsx)(R,{})}),Object(r.jsx)(Z,{})]}),Object(r.jsx)(ue,{}),Object(r.jsx)(de,{})]})};n(103);var fe={authorizeUser:function(){return function(e){e(O()),h.authorizeUser()}}};var je=Object(i.b)((function(e){return{isLogged:e.ui.isLogged}}),fe)((function(e){return e.isLogged?Object(r.jsx)(u.a,{to:"/home"}):Object(r.jsx)("div",{className:"NotLogged-Container",children:Object(r.jsxs)("div",{className:"NotLogged-Content",children:[Object(r.jsx)("h1",{className:"logo big",children:" Tasteify"}),Object(r.jsx)(S,{variant:"outlined",size:"large",color:"secondary",onClick:function(){return e.authorizeUser()},children:"Log in with Spotify"}),Object(r.jsx)("p",{style:{color:"#BFBFBF"},children:"Made by Quentin Floricourt and Brice Deguigne"})]})})})),be=n(62);var Oe=Object(i.b)((function(e){return{user:e.user.tokens}}))((function(e){var t=e.component,n=Object(be.a)(e,["component"]);return Object(r.jsx)(u.b,Object(L.a)(Object(L.a)({},n),{},{render:function(e){return n.user?Object(r.jsx)(t,Object(L.a)({},e)):Object(r.jsx)(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}));var ge={getAccessToken:function(e){return function(t){t(O()),h.getAccessToken(e).then((function(e){var n=e.data.access_token,r=e.data.refresh_token;localStorage.setItem("access_token",n),localStorage.setItem("refresh_token",r),t(b(n,r))})).catch((function(e){e.response?t(g(e.response)):t(g(e))}))}}},Te=Object(i.b)((function(e){return{user:e.user.user,isLogged:e.ui.isLogged}}),ge)((function(e){return Object(o.useEffect)((function(){if(!e.user){var t=function(e){var t,n,r,o=document.createElement("a"),a={};for(o.href=e,t=o.search.replace(/^\?/,"").split("&"),r=0;r<t.length;r++)a[(n=t[r].split("="))[0]]=decodeURIComponent(n[1]);return{protocol:o.protocol,host:o.host,hostname:o.hostname,port:o.port,pathname:o.pathname,search:o.search,params:a,hash:o.hash}}(window.location.href);t.params.code&&e.getAccessToken(t.params.code)}}),[e]),e.isLogged?Object(r.jsx)(u.a,{to:"/home"}):Object(r.jsx)(u.a,{to:"/login"})}));var me={authenticateUser:b};var _e=Object(i.b)((function(e){return{data:e.user.user,user:e.user.tokens,isLogged:e.ui.isLogged}}),me)((function(e){return Object(o.useEffect)((function(){var t=localStorage.getItem("access_token"),n=localStorage.getItem("refresh_token");!e.user&&t&&n&&e.authenticateUser(t,n)}),[e]),Object(r.jsxs)(u.d,{children:[Object(r.jsx)(u.b,{exact:!0,path:"/",children:Object(r.jsx)(Te,{})}),Object(r.jsx)(Oe,{path:"/home",component:he}),Object(r.jsx)(u.b,{path:"/login",children:Object(r.jsx)(je,{})}),Object(r.jsx)(u.b,{path:"/spotify/callback",children:Object(r.jsx)(Te,{})})]})}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=n(25),ve=n(36),Se=n(22),xe={pageTitle:"Tracks",isLogged:!1};var Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ve.uiConstants.SET_PAGE_TITLE:return Object(L.a)(Object(L.a)({},e),{},{pageTitle:t.name});case ve.uiConstants.LOG_USER:return Object(L.a)(Object(L.a)({},e),{},{isLogged:!e.isLogged});case Se.userConstants.LOG_USER_DISCONNECT:return xe;default:return e}},ke={},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Se.userConstants.LOG_USER_REQUEST:return{requesting:!0};case Se.userConstants.LOG_USER_STORE_TOKENS:return{tokens:t.tokens};case Se.userConstants.LOG_USER_STORE_USER:return Object(L.a)(Object(L.a)({},e),{},{user:t.user});case Se.userConstants.LOG_USER_FAILURE:return{error:t.error};case Se.userConstants.LOG_USER_DISCONNECT:return ke;default:return e}},ye={topTracksRequesting:!0,topGenresRequesting:!0},Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(L.a)(Object(L.a)({},e),{},{topTracksRequesting:!0});case I:return Object(L.a)(Object(L.a)({},e),{},{topGenresRequesting:!0});case C:return{error:t.error};case w:return Object(L.a)(Object(L.a)({},e),{},{topTracksRequesting:!1,topTracks:t.topTracks});case P:return Object(L.a)(Object(L.a)({},e),{},{topGenresRequesting:!1,topGenres:t.topGenres});case D:return Object(L.a)(Object(L.a)({},e),{},{topTracksRequesting:!1,topTracks:t.topTracks});case F:return Object(L.a)(Object(L.a)({},e),{},{topGenresRequesting:!1,topGenres:t.topGenres});case M:return Object(L.a)(Object(L.a)({},e),{},{topTracksRequesting:!1,topTracks:t.topTracks});case z:return Object(L.a)(Object(L.a)({},e),{},{topGenresRequesting:!1,topGenres:t.topGenres});default:return e}},Ae=Object(Ee.c)({ui:Re,user:Le,spotifyData:Ue}),Ge=n(61),Ne=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ee.d,Ie=Object(Ee.e)(Ae,Ne(Object(Ee.a)(Ge.a))),Ce=n(28);c.a.render(Object(r.jsx)(i.a,{store:Ie,children:Object(r.jsx)(Ce.a,{basename:"/",children:Object(r.jsx)(_e,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},22:function(e,t,n){"use strict";n.r(t),n.d(t,"userConstants",(function(){return r}));var r={LOG_USER_REQUEST:"USER_LOG_USER_REQUEST",LOG_USER_STORE_USER:"USER_LOG_USER_STORE_USER",LOG_USER_FAILURE:"USER_LOG_USER_FAILURE",LOG_USER_DISCONNECT:"USER_LOG_USER_DISCONNECT",LOG_USER_STORE_TOKENS:"USER_LOG_USER_STORE_TOKENS"}},36:function(e,t,n){"use strict";n.r(t),n.d(t,"uiConstants",(function(){return r}));var r={SET_PAGE_TITLE:"UI_SET_PAGE_TITLE",LOG_USER:"UI_LOG_USER"}},71:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.44580a2a.chunk.js.map